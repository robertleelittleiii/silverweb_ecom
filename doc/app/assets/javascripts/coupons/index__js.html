<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>index_.js - RDoc Documentation</title>

<link href="../../../../fonts.css" rel="stylesheet">
<link href="../../../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../../";
</script>

<script src="../../../../js/jquery.js"></script>
<script src="../../../../js/navigation.js"></script>
<script src="../../../../js/search_index.js"></script>
<script src="../../../../js/search.js"></script>
<script src="../../../../js/searcher.js"></script>
<script src="../../../../js/darkfish.js"></script>


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../../../Gemfile.html">Gemfile</a>
  
    <li><a href="../../../../Gemfile_lock.html">Gemfile.lock</a>
  
    <li><a href="../../../../LICENSE.html">LICENSE</a>
  
    <li><a href="../../../../MIT-LICENSE.html">MIT-LICENSE</a>
  
    <li><a href="../../../../README_rdoc.html">README</a>
  
    <li><a href="../../../../Rakefile.html">Rakefile</a>
  
    <li><a href="../../../../app/assets/javascripts/coupons/edit_js.html">edit.js</a>
  
    <li><a href="../../../../app/assets/javascripts/coupons/index__js.html">index_.js</a>
  
    <li><a href="../../../../app/assets/javascripts/coupons/shared_js.html">shared.js</a>
  
    <li><a href="../../../../app/assets/javascripts/imgpreview_full_jquery_js.html">imgpreview.full.jquery.js</a>
  
    <li><a href="../../../../app/assets/javascripts/jquery_jqzoom-core_js.html">jquery.jqzoom-core.js</a>
  
    <li><a href="../../../../app/assets/javascripts/jquery_serialize-object_js.html">jquery.serialize-object.js</a>
  
    <li><a href="../../../../app/assets/javascripts/menus/show_products_type_js.html">show_products_type.js</a>
  
    <li><a href="../../../../app/assets/javascripts/orders/enter_order_js.html">enter_order.js</a>
  
    <li><a href="../../../../app/assets/javascripts/orders/index__js.html">index_.js</a>
  
    <li><a href="../../../../app/assets/javascripts/orders/order_success_js.html">order_success.js</a>
  
    <li><a href="../../../../app/assets/javascripts/orders/user_orders_js.html">user_orders.js</a>
  
    <li><a href="../../../../app/assets/javascripts/product_related_products_js.html">product_related_products.js</a>
  
    <li><a href="../../../../app/assets/javascripts/products/coupon_settings_js.html">coupon_settings.js</a>
  
    <li><a href="../../../../app/assets/javascripts/products/edit_js.html">edit.js</a>
  
    <li><a href="../../../../app/assets/javascripts/products/index__js.html">index_.js</a>
  
    <li><a href="../../../../app/assets/javascripts/products/product_preferences_js.html">product_preferences.js</a>
  
    <li><a href="../../../../app/assets/javascripts/products/shared_js.html">shared.js</a>
  
    <li><a href="../../../../app/assets/javascripts/silverweb_ecom_js.html">silverweb_ecom.js</a>
  
    <li><a href="../../../../app/assets/javascripts/site/check_out_js.html">check_out.js</a>
  
    <li><a href="../../../../app/assets/javascripts/site/live_search_js.html">live_search.js</a>
  
    <li><a href="../../../../app/assets/javascripts/site/product_detail_js.html">product_detail.js</a>
  
    <li><a href="../../../../app/assets/javascripts/site/show_products_js.html">show_products.js</a>
  
    <li><a href="../../../../app/assets/javascripts/site/show_products_with_page_js.html">show_products_with_page.js</a>
  
    <li><a href="../../../../app/assets/javascripts/site/store_locator_js.html">store_locator.js</a>
  
    <li><a href="../../../../app/assets/javascripts/vendors/vendor_list_js.html">vendor_list.js</a>
  
    <li><a href="../../../../app/assets/stylesheets/customers_css.html">customers.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/jquery_jqzoom_scss.html">jquery.jqzoom.scss</a>
  
    <li><a href="../../../../app/assets/stylesheets/orders_css.html">orders.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/orders/index__css.html">index_.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/orders/user_orders_css.html">user_orders.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/product_related_products_css.html">product_related_products.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/products_css.html">products.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/products/edit_css.html">edit.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/products/product_list_scss.html">product_list.scss</a>
  
    <li><a href="../../../../app/assets/stylesheets/retailers_css.html">retailers.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/scaffold_css.html">scaffold.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/silverweb_ecom_css.html">silverweb_ecom.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/site/check_out_css.html">check_out.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/site/product_detail-horizontal_css.html">product_detail-horizontal.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/site/product_detail_css.html">product_detail.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/site/show_products_css.html">show_products.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/site/show_products_with_page_css.html">show_products_with_page.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/site/show_products_with_page_mm_css.html">show_products_with_page_mm.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/site/store_locator_css.html">store_locator.css</a>
  
    <li><a href="../../../../app/assets/stylesheets/vendors_css.html">vendors.css</a>
  
    <li><a href="../../../../app/mailers/user_notifier_old_rb_orig.html">user_notifier_old.rb.orig</a>
  
    <li><a href="../../../../app/views/products/delete_image_rjs.html">delete_image.rjs</a>
  
    <li><a href="../../../../app/views/site/product_index_feed_atom_builder.html">product_index_feed.atom.builder</a>
  
    <li><a href="../../../../lib/tasks/image_tasks_rake.html">image_tasks.rake</a>
  
    <li><a href="../../../../lib/tasks/silverweb_ecom_tasks_rake.html">silverweb_ecom_tasks.rake</a>
  
    <li><a href="../../../../nbproject/private/config_properties.html">config.properties</a>
  
    <li><a href="../../../../nbproject/private/private_properties.html">private.properties</a>
  
    <li><a href="../../../../nbproject/private/private_xml.html">private.xml</a>
  
    <li><a href="../../../../nbproject/private/rake-d_txt.html">rake-d</a>
  
    <li><a href="../../../../nbproject/project_properties.html">project.properties</a>
  
    <li><a href="../../../../nbproject/project_xml.html">project.xml</a>
  
    <li><a href="../../../../silverweb_ecom_gemspec.html">silverweb_ecom.gemspec</a>
  
    <li><a href="../../../../test/dummy/README_rdoc.html">README</a>
  
    <li><a href="../../../../test/dummy/Rakefile.html">Rakefile</a>
  
    <li><a href="../../../../test/dummy/app/assets/javascripts/application_js.html">application.js</a>
  
    <li><a href="../../../../test/dummy/app/assets/stylesheets/application_css.html">application.css</a>
  
    <li><a href="../../../../test/dummy/config_ru.html">config.ru</a>
  
    <li><a href="../../../../test/dummy/public/404_html.html">404.html</a>
  
    <li><a href="../../../../test/dummy/public/422_html.html">422.html</a>
  
    <li><a href="../../../../test/dummy/public/500_html.html">500.html</a>
  
    <li><a href="../../../../test/dummy/public/favicon_ico.html">favicon.ico</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page app/assets/javascripts/coupons/index_.js">

<p>var couponTableAjax; var coupons_index_callDocumentReady_called = false;</p>

<p>$(document).ready(function () {</p>

<pre>if (!coupons_index_callDocumentReady_called)
{
    coupons_index_callDocumentReady_called = true;
    if ($(&quot;#as_window&quot;).text() == &quot;true&quot;)
    {
        //  alert(&quot;it is a window&quot;);
    } else
    {
        coupons_index_callDocumentReady();
    }
}</pre>

<p>});</p>

<p>//function bindClicktoCouponTableRow(){ //    $(&#39;#coupon-table
.coupon-row&#39;).on(“click”,function(e){ //        console.log(e.target);
//        if (!($(e.target).prop(“class”) == “delete-image”)) //        {
//            $(this).addClass(&#39;row_selected&#39;); //           
couponID=$(this).find(“#coupon-id”).text(); //            window.location =
“/coupons/edit/”+couponID; //        } //    }); //}</p>

<p>function coupons_index_callDocumentReady() {</p>

<pre>requireCss(&quot;tables.css&quot;);
requireCss(&quot;coupons.css&quot;);
require(&quot;coupons/shared.js&quot;);

$(&quot;body&quot;).css(&quot;cursor&quot;, &quot;progress&quot;);

createCouponsTable();

$(&quot;body&quot;).css(&quot;cursor&quot;, &quot;default&quot;);

bindNewCoupon();

$(&quot;a.button-link&quot;).button();

bindDeleteCoupon();

$(&quot;.best_in_place&quot;).best_in_place();</pre>

<p>}</p>

<p>function bindDeleteCoupon() {</p>

<pre>$(&quot;.delete-coupon-item&quot;).on(&quot;click&quot;, function (e) {

    console.log($(this).parent().parent().parent().find(&#39;#coupon-id&#39;).text());
    var coupon_id = $(this).parent().parent().parent().find(&#39;#coupon-id&#39;).text();
    deleteCoupon(coupon_id);
    return false;
});</pre>

<p>}</p>

<p>function deleteCoupon(coupon_id) {</p>

<pre>var answer = confirm(&#39;Are you sure you want to delete this?&#39;)
if (answer) {
    $.ajax({
        url: &#39;/coupons/delete_ajax?id=&#39; + coupon_id,
        success: function (data)
        {
            setUpPurrNotifier(&quot;Notice&quot;, &quot;Item Successfully Deleted.&quot;);
            couponTableAjax.draw();

        }
    });

}</pre>

<p>}</p>

<p>function createCouponsTable() {</p>

<pre>couponTableAjax = $(&#39;#coupon-table&#39;).DataTable({
    pageLength: 25,
    lengthMenu: [[25, 50, 100], [25, 50, 100]],
    stateSave: true,
    stateDuration: 0,
    stateSaveCallback: function (settings, data) {
        localStorage.setItem(&#39;DataTables_coupon_&#39; + window.location.pathname, JSON.stringify(data));
    },
    stateLoadCallback: function (settings) {
        return JSON.parse(localStorage.getItem(&#39;DataTables_coupon_&#39; + window.location.pathname));
    },
    processing: true,
    order: [[0, &quot;asc&quot;]],
    serverSide: true,
    searchDelay: 500,
    ajax: {
        url: &quot;/coupons/coupon_table&quot;,
        type: &quot;post&quot;
    },
    rowCallback: function (row, data, index) {
        $(row).addClass(&#39;coupon-row&#39;);
        $(row).addClass(&#39;gradeA&#39;);
        //return row;
    },
    initComplete: function () {
        // $(&quot;.best_in_place&quot;).best_in_place(); 

    },
    drawCallback: function (settings) {

        couponeditClickBinding(&quot;tr.coupon-row&quot;);
        bindDeleteCoupon();

        image_list = $(&#39;a.zoom-image&#39;);
        if (image_list.length &gt; 0) {
            image_list.imgPreview();
        }
        $(&quot;td.dataTables_empty&quot;).attr(&quot;colspan&quot;, &quot;20&quot;)

    },
    columns: [
        {width: &#39;100&#39;},
        {width: &#39;600&#39;},
        {width: &#39;75&#39;},
        {width: &#39;75&#39;},
        {width: &#39;25&#39;},
        {width: &#39;25&#39;}
    ]</pre>

<p>//        ,“iDisplayLength”: 25, //        “aLengthMenu”: [[25, 50, 100],
[25, 50, 100]], //        “bStateSave”: true, //        “bProcessing”:
true, //        “bServerSide”: true, //        “sAjaxSource”:
“/coupons/coupon_table”, //        “fnRowCallback”: function( nRow, aData,
iDisplayIndex, iDisplayIndexFull ) { //           
$(nRow).addClass(&#39;coupon-row&#39;); //           
$(nRow).addClass(&#39;gradeA&#39;); //</p>

<p>//            return nRow; //        }, //</p>

<p>//        “aoColumns”:  //        [  //        { //            “sWidth”:
“100” //        }, //        { //            “sWidth”: “600” //        },
//        { //            “sWidth”: “75” //        }, //        { //       
“sWidth”: “75” //        }, //        { //            “sWidth”: “25” //    
}, //        { //            “sWidth”: “25” //        } //        ] //     
, //        “fnDrawCallback”: function (){ //           
couponeditClickBinding(“tr.coupon-row”); //            bindDeleteCoupon();
// //            image_list = $(&#39;a.zoom-image&#39;); //           
if(image_list.length &gt; 0){ //            image_list.imgPreview(); //    
} //        }</p>

<pre>});

$(&quot;#coupon-table&quot;).css(&quot;width&quot;, &quot;100%&quot;)</pre>

<p>}</p>

<p>function bindNewCoupon() {</p>

<pre>$(&#39;a#new-coupon&#39;).unbind().bind(&#39;ajax:beforeSend&#39;, function (e, xhr, settings) {
    xhr.setRequestHeader(&#39;accept&#39;, &#39;*  ;q=0.5, text/html, &#39; + settings.accepts.html);
    $(&quot;body&quot;).css(&quot;cursor&quot;, &quot;progress&quot;);
}).bind(&#39;ajax:success&#39;, function (xhr, data, status) {
    $(&quot;body&quot;).css(&quot;cursor&quot;, &quot;default&quot;);
    // editCoupon(data.id);

    couponTableAjax.draw();
    setUpPurrNotifier(&quot;Notice&quot;, &quot;New Coupon Created!&#39;&quot;);
}).bind(&#39;ajax:error&#39;, function (evt, xhr, status, error) {
    setUpPurrNotifier(&quot;Error&quot;, &quot;Coupon Creation Failed!&#39;&quot;);
});</pre>

<p>//    $(&#39;a#new-coupon&#39;).bind(&#39;ajax:beforeSend&#39;, function
(evt, xhr, settings) { //        // alert(“ajax:before”);</p>

<p>//        console.log(&#39;ajax:before&#39;); //        console.log(evt);
//        console.log(xhr); //        console.log(settings); // //       
$(“body”).css(“cursor”, “progress”); // // // //   
}).bind(&#39;ajax:success&#39;, function (evt, data, status, xhr) { //     
//  alert(“ajax:success”);  //        console.log(&#39;ajax:success&#39;);
//        console.log(evt); //        console.log(“date:” + data + “:”); //
//        $(“body”).css(“cursor”, “progress”); //       
console.log(data.id); //        editCoupon(data.id); // //       
console.log(status); //        console.log(xhr); // //   
}).bind(&#39;ajax:error&#39;, function (evt, xhr, status, error) { //      
// alert(“ajax:failure”);  //        console.log(&#39;ajax:error&#39;); // 
console.log(evt); //        console.log(xhr); //       
console.log(status); //        console.log(error); // //       
alert(“Error:” + <a href=""error"">JSON.parse(data.responseText)</a>); //  
$(“body”).css(“cursor”, “default”); // // //   
}).bind(&#39;ajax:complete&#39;, function (evt, xhr, status) { //        //
alert(“ajax:complete”);</p>

<p>//        console.log(&#39;ajax:complete&#39;); //        console.log(evt);
//        console.log(xhr); //        // console.log(status); //       
$(“body”).css(“cursor”, “default”); // // //    });</p>

<p>}</p>

<p>function bindPreferences() {</p>

<pre>$(&#39;a#coupon-prefs&#39;).unbind().bind(&#39;ajax:beforeSend&#39;, function (e, xhr, settings) {
    xhr.setRequestHeader(&#39;accept&#39;, &#39;  *;q=0.5, text/html, &#39; + settings.accepts.html);
    $(&quot;body&quot;).css(&quot;cursor&quot;, &quot;progress&quot;);
}).bind(&#39;ajax:success&#39;, function (xhr, data, status) {
    $(&quot;body&quot;).css(&quot;cursor&quot;, &quot;default&quot;);
    couponPrefsDialog = createAppDialog(data, &quot;coupon-prefs-dialog&quot;);
    couponPrefsDialog.dialog(&#39;open&#39;);
    couponPrefsDialog.dialog({
        close: function (event, ui) {
            couponPrefsDialog.html(&quot;&quot;);
            couponPrefsDialog.dialog(&quot;destroy&quot;);
        }
    });
    require(&quot;coupons/coupon_preferences.js&quot;);
    coupon_preferences_callDocumentReady();

    //update_rolls_callDocumentReady();

    // setupRolesSelection();
    // 
}).bind(&#39;ajax:error&#39;, function (evt, xhr, status, error) {
    setUpPurrNotifier(&quot;Error&quot;, &quot;Prefs could not be opened!&#39;&quot;);
});</pre>

<p>}</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

