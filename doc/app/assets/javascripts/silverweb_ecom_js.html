<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>silverweb_ecom.js - RDoc Documentation</title>

<link href="../../../fonts.css" rel="stylesheet">
<link href="../../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../";
</script>

<script src="../../../js/jquery.js"></script>
<script src="../../../js/navigation.js"></script>
<script src="../../../js/search_index.js"></script>
<script src="../../../js/search.js"></script>
<script src="../../../js/searcher.js"></script>
<script src="../../../js/darkfish.js"></script>


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../../Gemfile.html">Gemfile</a>
  
    <li><a href="../../../Gemfile_lock.html">Gemfile.lock</a>
  
    <li><a href="../../../LICENSE.html">LICENSE</a>
  
    <li><a href="../../../MIT-LICENSE.html">MIT-LICENSE</a>
  
    <li><a href="../../../README_rdoc.html">README</a>
  
    <li><a href="../../../Rakefile.html">Rakefile</a>
  
    <li><a href="../../../app/assets/javascripts/coupons/edit_js.html">edit.js</a>
  
    <li><a href="../../../app/assets/javascripts/coupons/index__js.html">index_.js</a>
  
    <li><a href="../../../app/assets/javascripts/coupons/shared_js.html">shared.js</a>
  
    <li><a href="../../../app/assets/javascripts/imgpreview_full_jquery_js.html">imgpreview.full.jquery.js</a>
  
    <li><a href="../../../app/assets/javascripts/jquery_jqzoom-core_js.html">jquery.jqzoom-core.js</a>
  
    <li><a href="../../../app/assets/javascripts/jquery_serialize-object_js.html">jquery.serialize-object.js</a>
  
    <li><a href="../../../app/assets/javascripts/menus/show_products_type_js.html">show_products_type.js</a>
  
    <li><a href="../../../app/assets/javascripts/orders/enter_order_js.html">enter_order.js</a>
  
    <li><a href="../../../app/assets/javascripts/orders/index__js.html">index_.js</a>
  
    <li><a href="../../../app/assets/javascripts/orders/order_success_js.html">order_success.js</a>
  
    <li><a href="../../../app/assets/javascripts/orders/user_orders_js.html">user_orders.js</a>
  
    <li><a href="../../../app/assets/javascripts/product_related_products_js.html">product_related_products.js</a>
  
    <li><a href="../../../app/assets/javascripts/products/coupon_settings_js.html">coupon_settings.js</a>
  
    <li><a href="../../../app/assets/javascripts/products/edit_js.html">edit.js</a>
  
    <li><a href="../../../app/assets/javascripts/products/index__js.html">index_.js</a>
  
    <li><a href="../../../app/assets/javascripts/products/product_preferences_js.html">product_preferences.js</a>
  
    <li><a href="../../../app/assets/javascripts/products/shared_js.html">shared.js</a>
  
    <li><a href="../../../app/assets/javascripts/silverweb_ecom_js.html">silverweb_ecom.js</a>
  
    <li><a href="../../../app/assets/javascripts/site/check_out_js.html">check_out.js</a>
  
    <li><a href="../../../app/assets/javascripts/site/live_search_js.html">live_search.js</a>
  
    <li><a href="../../../app/assets/javascripts/site/product_detail_js.html">product_detail.js</a>
  
    <li><a href="../../../app/assets/javascripts/site/show_products_js.html">show_products.js</a>
  
    <li><a href="../../../app/assets/javascripts/site/show_products_with_page_js.html">show_products_with_page.js</a>
  
    <li><a href="../../../app/assets/javascripts/site/store_locator_js.html">store_locator.js</a>
  
    <li><a href="../../../app/assets/javascripts/vendors/vendor_list_js.html">vendor_list.js</a>
  
    <li><a href="../../../app/assets/stylesheets/customers_css.html">customers.css</a>
  
    <li><a href="../../../app/assets/stylesheets/jquery_jqzoom_scss.html">jquery.jqzoom.scss</a>
  
    <li><a href="../../../app/assets/stylesheets/orders_css.html">orders.css</a>
  
    <li><a href="../../../app/assets/stylesheets/orders/index__css.html">index_.css</a>
  
    <li><a href="../../../app/assets/stylesheets/orders/user_orders_css.html">user_orders.css</a>
  
    <li><a href="../../../app/assets/stylesheets/product_related_products_css.html">product_related_products.css</a>
  
    <li><a href="../../../app/assets/stylesheets/products_css.html">products.css</a>
  
    <li><a href="../../../app/assets/stylesheets/products/edit_css.html">edit.css</a>
  
    <li><a href="../../../app/assets/stylesheets/products/product_list_scss.html">product_list.scss</a>
  
    <li><a href="../../../app/assets/stylesheets/retailers_css.html">retailers.css</a>
  
    <li><a href="../../../app/assets/stylesheets/scaffold_css.html">scaffold.css</a>
  
    <li><a href="../../../app/assets/stylesheets/silverweb_ecom_css.html">silverweb_ecom.css</a>
  
    <li><a href="../../../app/assets/stylesheets/site/check_out_css.html">check_out.css</a>
  
    <li><a href="../../../app/assets/stylesheets/site/product_detail-horizontal_css.html">product_detail-horizontal.css</a>
  
    <li><a href="../../../app/assets/stylesheets/site/product_detail_css.html">product_detail.css</a>
  
    <li><a href="../../../app/assets/stylesheets/site/show_products_css.html">show_products.css</a>
  
    <li><a href="../../../app/assets/stylesheets/site/show_products_with_page_css.html">show_products_with_page.css</a>
  
    <li><a href="../../../app/assets/stylesheets/site/show_products_with_page_mm_css.html">show_products_with_page_mm.css</a>
  
    <li><a href="../../../app/assets/stylesheets/site/store_locator_css.html">store_locator.css</a>
  
    <li><a href="../../../app/assets/stylesheets/vendors_css.html">vendors.css</a>
  
    <li><a href="../../../app/mailers/user_notifier_old_rb_orig.html">user_notifier_old.rb.orig</a>
  
    <li><a href="../../../app/views/products/delete_image_rjs.html">delete_image.rjs</a>
  
    <li><a href="../../../app/views/site/product_index_feed_atom_builder.html">product_index_feed.atom.builder</a>
  
    <li><a href="../../../lib/tasks/image_tasks_rake.html">image_tasks.rake</a>
  
    <li><a href="../../../lib/tasks/silverweb_ecom_tasks_rake.html">silverweb_ecom_tasks.rake</a>
  
    <li><a href="../../../nbproject/private/config_properties.html">config.properties</a>
  
    <li><a href="../../../nbproject/private/private_properties.html">private.properties</a>
  
    <li><a href="../../../nbproject/private/private_xml.html">private.xml</a>
  
    <li><a href="../../../nbproject/private/rake-d_txt.html">rake-d</a>
  
    <li><a href="../../../nbproject/project_properties.html">project.properties</a>
  
    <li><a href="../../../nbproject/project_xml.html">project.xml</a>
  
    <li><a href="../../../silverweb_ecom_gemspec.html">silverweb_ecom.gemspec</a>
  
    <li><a href="../../../test/dummy/README_rdoc.html">README</a>
  
    <li><a href="../../../test/dummy/Rakefile.html">Rakefile</a>
  
    <li><a href="../../../test/dummy/app/assets/javascripts/application_js.html">application.js</a>
  
    <li><a href="../../../test/dummy/app/assets/stylesheets/application_css.html">application.css</a>
  
    <li><a href="../../../test/dummy/config_ru.html">config.ru</a>
  
    <li><a href="../../../test/dummy/public/404_html.html">404.html</a>
  
    <li><a href="../../../test/dummy/public/422_html.html">422.html</a>
  
    <li><a href="../../../test/dummy/public/500_html.html">500.html</a>
  
    <li><a href="../../../test/dummy/public/favicon_ico.html">favicon.ico</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page app/assets/javascripts/silverweb_ecom.js">

<pre>To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.</pre>

<p>$(document).ready(function () {</p>

<pre>enableProductEdit();</pre>

<p>});</p>

<p>function enableProductEdit() {</p>

<pre>if ($(&quot;div.edit-product&quot;).length &gt; 0)
{
    require(&quot;products/shared.js&quot;);
    producteditClickBinding(&quot;div.edit-product&quot;);
}</pre>

<p>}</p>

<p>function ui_ajax_cart_select() {</p>

<pre>$(&quot;select.ui-ajax-cart-select&quot;).bind(&quot;change&quot;, function () {
    selected_item = $(this).val();
    controller = this.getAttribute(&quot;data-path&quot;)

    //alert(this.getAttribute(&quot;data-id&quot;));

    $.ajax({
        url: controller, // controller + &quot;/update&quot;,
        dataType: &quot;json&quot;,
        type: &quot;PUT&quot;,
        data: &quot;id=&quot; + this.getAttribute(&quot;data-id&quot;) + &quot;&amp;cart[&quot; + this.getAttribute(&quot;name&quot;) + &quot;=&quot; + selected_item,
        success: function (data)
        {
            // alert(data);
            if (data === undefined || data === null || data === &quot;&quot;)
            {
                //display warning
            }
            else
            {

            }
        }
    });
});</pre>

<p>}</p>

<p>// live search</p>

<p>function ajaxUpdateSearch(search_term) {</p>

<pre>var form = $(&quot;#live-search&quot;); // grab the form wrapping the search bar.
var url = &quot;/site/live_product_search&quot;; // live_search action.

requireCss(&quot;site/live_product_search.css&quot;);
require(&quot;site/show_products.js&quot;);

updatePageForSearch();

if (search_term == null)
{
    var State = History.getState(); // Note: We are using History.getState() instead of event.state
    window.location.href = State.url;
    //       History.log(State.data, State.title, State.url);
    console.log(&quot;search_term == null&quot;);
    //    $(&quot;#search-image&quot;).removeClass(&quot;loading&quot;); // hide the spinner
    $(&quot;body&quot;).css(&quot;cursor&quot;, &quot;default&quot;);
    return;
}

if (queryString(&quot;search&quot;) == $(&quot;#live-search #live-search_search&quot;).val().trim())
{
    console.log(&quot;skip update, already loaded&quot;);
    $(&quot;body&quot;).css(&quot;cursor&quot;, &quot;default&quot;);
    // $(&quot;#search-image&quot;).removeClass(&quot;loading&quot;); // hide the spinner

    return;
}

if (search_term == &quot;&quot;)
{
    var formValue = $(&quot;#live-search #live-search_search&quot;).val().trim();
    console.log(&quot;search_term == &#39;&#39;&quot;);
}

else
{
    // $(&quot;#live-search #live-search_search&quot;).val(search_term);
    var formData = &quot;search=&quot; + search_term;
    var formValue = search_term.trim();
}

var full_search_url = url + &quot;?search=&quot; + formValue;

$.ajax({
    url: full_search_url,
    cache: false,
    success: function (data) {
        // $(&quot;#page-left&quot;).hide();
        $(&quot;body&quot;).css(&quot;cursor&quot;, &quot;default&quot;);

        // $(&quot;#search-image&quot;).removeClass(&quot;loading&quot;); // hide the spinner

        $(&quot;#content&quot;).html(data); // replace the &quot;results&quot; div with the results

        // $(&quot;#mainnav&quot;).hide();// hide the admin menu
        $(&quot;#live-search_search&quot;).focus();
        $(&quot;#live-search_search&quot;).caretToEnd();
        // $(&quot;#page-middle-left&quot;).fadeOut(&quot;10s&quot;);
        location_url = window.location.url;
        ////console.log(location_url);
        history_url = &quot;/site/live_product_search?search=&quot; + formValue;
        history_url = history_url.replace(/^.*#/, &#39;&#39;);
        ////console.log(history_url);

        History.pushState(&#39;statechange:&#39;, &quot;Search for &#39;&quot; + formValue + &quot;&#39;&quot;, history_url);
        // History.log(&#39;statechange:&#39;, &quot;Search for &#39;&quot;+ formValue +&quot;&#39;&quot;, history_url);

        //  History.pushState(&quot;&quot;,&quot;&quot;,history_url) 
        $(&quot;body&quot;).css(&quot;cursor&quot;, &quot;default&quot;);

        // $(&quot;#search-image&quot;).removeClass(&quot;loading&quot;); // hide the spinner
        // $(&quot;#live-search #live-search_search&quot;).val(formValue);

        // updateSearchFormBindings();
        bindClickToProductItem();
        enableProductEdit();

        //alert(&#39;Load was performed.&#39;);
    },
    error: function (jqXHR, textStatus, errorThrown) {
        // document.location.href = full_search_url;
        console.log(jqXHR);
        console.log(textStatus);
        console.log(errorThrown);

        return;
    }
});</pre>

<p>}</p>

<p>function updateSearchFormBindings() {</p>

<pre>// set the search term before we set up bindings.
search_term = queryString(&quot;search&quot;);
$(&quot;#live-search #live-search_search&quot;).val(search_term);

// Executes a callback detecting changes with a frequency of 1 second
$(&quot;#live-search_search&quot;).observe_field(1, function () {
    $(&quot;body&quot;).css(&quot;cursor&quot;, &quot;wait&quot;);

    // $(&quot;#search-image&quot;).addClass(&quot;loading&quot;); // show the spinner
    ajaxUpdateSearch(&quot;&quot;);

});

$(&quot;#live-search_search&quot;).keypress(function (e) {
    if (e.which == 13) {
        return false;
    }
});</pre>

<p>}</p>

<p>function queryString(key) {</p>

<pre>var re = new RegExp(&quot;[?&amp;]&quot; + key + &quot;=([^&amp;$]*)&quot;, &quot;i&quot;);
var offset = location.search.search(re);
if (offset == -1)
    return null;
return RegExp.$1;</pre>

<p>}</p>

<p>function enableHistory() {</p>

<pre>History = window.History; // Note: We are using a capital H instead of a lower h
var State = History.getState(); // Note: We are using History.getState() instead of event.state
//window.location.href=State.url;
//  History.pushState(State.data, State.title, State.url);
//History.log(State.data, State.title, State.url);

if (!History.enabled) {
    // History.js is disabled for this browser.
    // This is because we can optionally choose to support HTML4 browsers or not.
    return false;
}

// Bind to StateChange Event
History.Adapter.bind(window, &#39;statechange&#39;, function () { // Note: We are using statechange instead of popstate
    var State = History.getState(); // Note: We are using History.getState() instead of event.state
    //       window.location.href=State.url;
    //       History.log(State.data, State.title, State.url);
    search_term = queryString(&quot;search&quot;);
    //       console.log(&quot;search_term ==&#39;&quot; + search_term +&quot;&#39;&quot;);
    ajaxUpdateSearch(search_term);

});</pre>

<p>}</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

